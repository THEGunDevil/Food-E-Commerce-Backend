// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: delivery_zone.sql

package db

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const createDeliveryZone = `-- name: CreateDeliveryZone :one
INSERT INTO delivery_zones (
    zone_name,
    area_names,
    delivery_fee,
    min_delivery_time,
    max_delivery_time,
    is_active
) VALUES (
    $1, $2, $3, $4, $5, $6
)
RETURNING id, zone_name, area_names, delivery_fee, min_delivery_time, max_delivery_time, is_active, created_at, updated_at
`

type CreateDeliveryZoneParams struct {
	ZoneName        string         `json:"zone_name"`
	AreaNames       []string       `json:"area_names"`
	DeliveryFee     pgtype.Numeric `json:"delivery_fee"`
	MinDeliveryTime pgtype.Int4    `json:"min_delivery_time"`
	MaxDeliveryTime pgtype.Int4    `json:"max_delivery_time"`
	IsActive        pgtype.Bool    `json:"is_active"`
}

func (q *Queries) CreateDeliveryZone(ctx context.Context, arg CreateDeliveryZoneParams) (DeliveryZone, error) {
	row := q.db.QueryRow(ctx, createDeliveryZone,
		arg.ZoneName,
		arg.AreaNames,
		arg.DeliveryFee,
		arg.MinDeliveryTime,
		arg.MaxDeliveryTime,
		arg.IsActive,
	)
	var i DeliveryZone
	err := row.Scan(
		&i.ID,
		&i.ZoneName,
		&i.AreaNames,
		&i.DeliveryFee,
		&i.MinDeliveryTime,
		&i.MaxDeliveryTime,
		&i.IsActive,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const deleteDeliveryZone = `-- name: DeleteDeliveryZone :exec
DELETE FROM delivery_zones
WHERE id = $1
`

func (q *Queries) DeleteDeliveryZone(ctx context.Context, id pgtype.UUID) error {
	_, err := q.db.Exec(ctx, deleteDeliveryZone, id)
	return err
}

const getDeliveryZoneByArea = `-- name: GetDeliveryZoneByArea :one
SELECT id, zone_name, area_names, delivery_fee, min_delivery_time, max_delivery_time, is_active, created_at, updated_at
FROM delivery_zones
WHERE $1 = ANY(area_names)
  AND is_active = TRUE
LIMIT 1
`

func (q *Queries) GetDeliveryZoneByArea(ctx context.Context, areaNames []string) (DeliveryZone, error) {
	row := q.db.QueryRow(ctx, getDeliveryZoneByArea, areaNames)
	var i DeliveryZone
	err := row.Scan(
		&i.ID,
		&i.ZoneName,
		&i.AreaNames,
		&i.DeliveryFee,
		&i.MinDeliveryTime,
		&i.MaxDeliveryTime,
		&i.IsActive,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getDeliveryZoneByID = `-- name: GetDeliveryZoneByID :one
SELECT id, zone_name, area_names, delivery_fee, min_delivery_time, max_delivery_time, is_active, created_at, updated_at
FROM delivery_zones
WHERE id = $1
`

func (q *Queries) GetDeliveryZoneByID(ctx context.Context, id pgtype.UUID) (DeliveryZone, error) {
	row := q.db.QueryRow(ctx, getDeliveryZoneByID, id)
	var i DeliveryZone
	err := row.Scan(
		&i.ID,
		&i.ZoneName,
		&i.AreaNames,
		&i.DeliveryFee,
		&i.MinDeliveryTime,
		&i.MaxDeliveryTime,
		&i.IsActive,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const listActiveDeliveryZones = `-- name: ListActiveDeliveryZones :many
SELECT id, zone_name, area_names, delivery_fee, min_delivery_time, max_delivery_time, is_active, created_at, updated_at
FROM delivery_zones
WHERE is_active = TRUE
ORDER BY zone_name ASC
`

func (q *Queries) ListActiveDeliveryZones(ctx context.Context) ([]DeliveryZone, error) {
	rows, err := q.db.Query(ctx, listActiveDeliveryZones)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []DeliveryZone
	for rows.Next() {
		var i DeliveryZone
		if err := rows.Scan(
			&i.ID,
			&i.ZoneName,
			&i.AreaNames,
			&i.DeliveryFee,
			&i.MinDeliveryTime,
			&i.MaxDeliveryTime,
			&i.IsActive,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listDeliveryZones = `-- name: ListDeliveryZones :many
SELECT id, zone_name, area_names, delivery_fee, min_delivery_time, max_delivery_time, is_active, created_at, updated_at
FROM delivery_zones
ORDER BY created_at DESC
`

func (q *Queries) ListDeliveryZones(ctx context.Context) ([]DeliveryZone, error) {
	rows, err := q.db.Query(ctx, listDeliveryZones)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []DeliveryZone
	for rows.Next() {
		var i DeliveryZone
		if err := rows.Scan(
			&i.ID,
			&i.ZoneName,
			&i.AreaNames,
			&i.DeliveryFee,
			&i.MinDeliveryTime,
			&i.MaxDeliveryTime,
			&i.IsActive,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const toggleDeliveryZoneStatus = `-- name: ToggleDeliveryZoneStatus :one
UPDATE delivery_zones
SET
    is_active = $2,
    updated_at = CURRENT_TIMESTAMP
WHERE id = $1
RETURNING id, zone_name, area_names, delivery_fee, min_delivery_time, max_delivery_time, is_active, created_at, updated_at
`

type ToggleDeliveryZoneStatusParams struct {
	ID       pgtype.UUID `json:"id"`
	IsActive pgtype.Bool `json:"is_active"`
}

func (q *Queries) ToggleDeliveryZoneStatus(ctx context.Context, arg ToggleDeliveryZoneStatusParams) (DeliveryZone, error) {
	row := q.db.QueryRow(ctx, toggleDeliveryZoneStatus, arg.ID, arg.IsActive)
	var i DeliveryZone
	err := row.Scan(
		&i.ID,
		&i.ZoneName,
		&i.AreaNames,
		&i.DeliveryFee,
		&i.MinDeliveryTime,
		&i.MaxDeliveryTime,
		&i.IsActive,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateDeliveryZone = `-- name: UpdateDeliveryZone :one
UPDATE delivery_zones
SET
    zone_name = $2,
    area_names = $3,
    delivery_fee = $4,
    min_delivery_time = $5,
    max_delivery_time = $6,
    is_active = $7,
    updated_at = CURRENT_TIMESTAMP
WHERE id = $1
RETURNING id, zone_name, area_names, delivery_fee, min_delivery_time, max_delivery_time, is_active, created_at, updated_at
`

type UpdateDeliveryZoneParams struct {
	ID              pgtype.UUID    `json:"id"`
	ZoneName        string         `json:"zone_name"`
	AreaNames       []string       `json:"area_names"`
	DeliveryFee     pgtype.Numeric `json:"delivery_fee"`
	MinDeliveryTime pgtype.Int4    `json:"min_delivery_time"`
	MaxDeliveryTime pgtype.Int4    `json:"max_delivery_time"`
	IsActive        pgtype.Bool    `json:"is_active"`
}

func (q *Queries) UpdateDeliveryZone(ctx context.Context, arg UpdateDeliveryZoneParams) (DeliveryZone, error) {
	row := q.db.QueryRow(ctx, updateDeliveryZone,
		arg.ID,
		arg.ZoneName,
		arg.AreaNames,
		arg.DeliveryFee,
		arg.MinDeliveryTime,
		arg.MaxDeliveryTime,
		arg.IsActive,
	)
	var i DeliveryZone
	err := row.Scan(
		&i.ID,
		&i.ZoneName,
		&i.AreaNames,
		&i.DeliveryFee,
		&i.MinDeliveryTime,
		&i.MaxDeliveryTime,
		&i.IsActive,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}
